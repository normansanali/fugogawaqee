<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>Segmented Memory Allocation in Software - ZingX</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content="So far weve talked about the hardware, and having finally explained the hardware basis of segmented memory we can begin to understand the role software plays, and how software allocates memory among the two segments."><meta name=robots content="index,follow,noarchive"><meta property="og:title" content="Segmented Memory Allocation in Software"><meta property="og:description" content="So far weve talked about the hardware, and having finally explained the hardware basis of segmented memory we can begin to understand the role software plays, and how software allocates memory among the two segments."><meta property="og:type" content="article"><meta property="og:url" content="/geforce-gtx-970-correcting-the-specs-exploring-memory-allocation.html"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-08-23T00:00:00+00:00"><meta property="article:modified_time" content="2024-08-23T00:00:00+00:00"><meta itemprop=name content="Segmented Memory Allocation in Software"><meta itemprop=description content="So far weve talked about the hardware, and having finally explained the hardware basis of segmented memory we can begin to understand the role software plays, and how software allocates memory among the two segments."><meta itemprop=datePublished content="2024-08-23T00:00:00+00:00"><meta itemprop=dateModified content="2024-08-23T00:00:00+00:00"><meta itemprop=wordCount content="773"><meta itemprop=keywords content><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=https://assets.cdnweb.info/hugo/mainroad/css/style.css><link rel="shortcut icon" href=./favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=./index.html title=ZingX rel=home><div class="logo__item logo__text"><div class=logo__title>ZingX</div></div></a></div><div class=divider></div></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>Segmented Memory Allocation in Software</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2024-08-23T00:00:00Z>August 23, 2024</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=./categories/blog/ rel=category>blog</a></span></div></div></header><div class="content post__content clearfix"><p>So far we’ve talked about the hardware, and having finally explained the hardware basis of segmented memory we can begin to understand the role software plays, and how software allocates memory among the two segments.</p><p>From a low-level perspective, video memory management under Windows is the domain of the combination of the operating system and the video drivers. Strictly speaking Windows controls video memory management – this being one of the big changes of Windows Vista and the Windows Display Driver Model – while the video drivers get a significant amount of input in hinting at how things should be laid out.</p><p>Meanwhile from an application’s perspective <a href=#>all video memory and its address space is virtual</a>. This means that applications are writing to their own private space, blissfully unaware of what else is in video memory and where it may be, or for that matter where in memory (or even which memory) they are writing. As a result of this memory virtualization it falls to the OS and video drivers to decide where in physical VRAM to allocate memory requests, and for the GTX 970 in particular, whether to put a request in the 3.5GB segment, the 512MB segment, or in the worst case scenario system memory over PCIe.</p><p align=center><a href=#><img alt src=https://cdn.statically.io/img/images.anandtech.com/doci/8935/Virtual_address_space_and_physical_address_space_relationship_575px.png style=margin:auto;display:block;text-align:center;max-width:100%;height:auto></a><br>Virtual Address Space (Image Courtesy <a href=#>Dysprosia</a>)</p><p>Without going quite so far to rehash the entire theory of memory management and caching, the goal of memory management in the case of the GTX 970 is to allocate resources over the entire 4GB of VRAM such that high-priority items end up in the fast segment and low-priority items end up in the slow segment. To do this NVIDIA focuses up to the first 3.5GB of memory allocations on the faster 3.5GB segment, and then finally for memory allocations beyond 3.5GB they turn to the 512MB segment, as there’s no benefit to using the slower segment so long as there’s available space in the faster segment.</p><p>The complex part of this process occurs once both memory segments are in use, at which point NVIDIA’s heuristics come into play to try to best determine which resources to allocate to which segments. How NVIDIA does this is very much a “secret sauce” scenario for the company, but from a high level identifying the type of resource and when it was last used are good ways to figure out where to send a resource. Frame buffers, render targets, UAVs, and other intermediate buffers for example are the last thing you want to send to the slow segment;&nbsp;meanwhile textures, resources not in active use (e.g. cached), and resources belonging to inactive applications would be great candidates to send off to the slower segment. The way NVIDIA describes the process we suspect there are even per-application optimizations in use, though NVIDIA can clearly handle generic cases as well.</p><p>From an API perspective this is applicable towards both graphics and compute, though it’s a safe bet that graphics is the more easily and accurately handled of the two thanks to the rigid nature of graphics rendering. Direct3D, OpenGL, CUDA, and OpenCL all see and have access to the full 4GB of memory available on the GTX 970, and from the perspective of the applications using these APIs the 4GB of memory is identical, the segments being abstracted. This is also why applications attempting to benchmark the memory in a piecemeal fashion will not find slow memory areas until the end of their run, as their earlier allocations will be in the fast segment and only finally spill over to the slow segment once the fast segment is full.</p><table align=center border=1 bordercolor=#dddddd cellpadding=3 cellspacing=0 width=500><tbody readability=1><tr class=tgrey readability=2><td align=center colspan=4>GeForce GTX 970 Addressable VRAM</td></tr><tr class=tlblue><td align=center bgcolor=#016a96 class=contentwhite width=170>API</td><td align=center bgcolor=#016a96 class=contentwhite width=312>Memory</td></tr><tr><td class=tlgrey><strong>Direct3D</strong></td><td align=center bgcolor=#f7f7f7>4GB</td></tr><tr><td class=tlgrey><strong>OpenGL</strong></td><td align=center bgcolor=#f7f7f7>4GB</td></tr><tr><td class=tlgrey><strong>CUDA</strong></td><td align=center bgcolor=#f7f7f7>4GB</td></tr><tr><td class=tlgrey><strong>OpenCL</strong></td><td align=center bgcolor=#f7f7f7>4GB</td></tr></tbody></table><p align=center><a href=#><img alt src=https://cdn.statically.io/img/images.anandtech.com/doci/8935/GTX970_OCL_575px.png style=margin:auto;display:block;text-align:center;max-width:100%;height:auto></a></p><p>The one remaining unknown element here (and something NVIDIA is still investigating) is why some users have been seeing total VRAM allocation top out at 3.5GB on a GTX 970, but go to 4GB on a GTX 980. Again from a high-level perspective all of this segmentation is abstracted, so games should not be aware of what’s going on under the hood.</p><p>Overall then the role of software in memory allocation is relatively straightforward since it’s layered on top of the segments. Applications have access to the full 4GB, and due to the fact that application memory space is virtualized the existence and usage of the memory segments is abstracted from the application, with the physical memory allocation handled by the OS and driver. Only after 3.5GB is requested – enough to fill the entire 3.5GB segment – does the 512MB segment get used, at which point NVIDIA attempts to place the least sensitive/important data in the slower segment.</p><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmivp6x7orrAp5utnZOde6S7zGiqoaenZIV6f5Ronp6en6ewpnnGra9mcWdleqS70aucnKyZo7RuwMeeZKyolZjAbrHXqaOoqpmjtG65xKamq7Fdlrmtu8Kaq6KnnmSA</p></div></article></main><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=./tom-bergeron-height-weight-net-worth-age-birthday-wikipedia-who-nationality-biography-110986-html.html rel=prev><span class=pager__subtitle>«&#8201;Previous</span><p class=pager__title>Tom Bergeron Height, Weight, Net Worth, Age, Birthday, Wikipedia, Who, Nationality, Biography</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=./birds-prey-trailer-positively-fantabulous.html rel=next><span class=pager__subtitle>Next&#8201;»</span><p class=pager__title>New Birds Of Prey Trailer Is Positively Fantabulous</p></a></div></nav></div><aside class=sidebar><div class="widget-recent widget"><h4 class=widget__title>Recent Posts</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=./12-awesome-easter-eggs-hidden-in-the-resident-evil-4-remake.html>12 awesome Easter Eggs hidden in the Resident Evil 4 Remake</a></li><li class=widget__item><a class=widget__link href=./summer-tv-preview-2020-shows-to-watch-4073529.html>13 Reasons Why &amp;amp; More Shows To Watch Hollywood Life</a></li><li class=widget__item><a class=widget__link href=./aerodactyl-gl-rising-rivals-55.html>Aerodactyl GL (Rising Rivals 55)</a></li><li class=widget__item><a class=widget__link href=./brooke-smith-net-worth-132013.html>Brooke Smith Net Worth</a></li><li class=widget__item><a class=widget__link href=./how-is-fai-khadra-related-to-the-kardashians.html>How is fai Khadra related to the Kardashians?</a></li></ul></div></div><div class="widget-categories widget"><h4 class=widget__title>Categories</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=./categories/blog/>blog</a></li></ul></div></div></aside></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2024 ZingX.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=https://assets.cdnweb.info/hugo/mainroad/js/menu.js></script>
<script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>